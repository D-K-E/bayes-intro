<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.19"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>PyGModels: Usage Examples</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">PyGModels
   </div>
   <div id="projectbrief">Probabilistic Graphical Models by the book</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.19 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Usage Examples </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md21"></a>
PGModel Usage</h1>
<p><code>PGModel</code>, a graph with defined as <code>G=(V,E,F)</code> where <code>V</code> is vertex set composed of <code>NumCatRVariable</code>s which are numeric categorical random variables, <code>E</code> is edge set, and <code>F</code> is factor set. If <code>F</code> is none the factor set is deduced from edge set where each edge is considered as a factor whose scope is the set of incident nodes to edge. Sum-Product and Max-Product variable elimination are supported by <code>PGModel</code>. Evidence encoded in nodes are directly used for reducing factors during the instantiation of <code>PGModel</code>. Additional evidence can be provided at query time as well for conditional and most probable explanation queries. <code>Marginal Map</code> queries are not yet supported.</p>
<p>Usage:</p>
<div class="fragment"><div class="line">from gmodels.pgmodel import PGModel</div>
<div class="line">from gmodels.gtypes.edge import Edge, EdgeType</div>
<div class="line">from gmodels.factor import Factor</div>
<div class="line">from gmodels.randomvariable import NumCatRVariable</div>
<div class="line"># Example adapted from Darwiche 2009, p. 140</div>
<div class="line">idata = {</div>
<div class="line">            &quot;a&quot;: {&quot;outcome-values&quot;: [True, False]},</div>
<div class="line">            &quot;b&quot;: {&quot;outcome-values&quot;: [True, False]},</div>
<div class="line">            &quot;c&quot;: {&quot;outcome-values&quot;: [True, False]},</div>
<div class="line">        }</div>
<div class="line">a = NumCatRVariable(</div>
<div class="line">            node_id=&quot;a&quot;, input_data=idata[&quot;a&quot;], distribution=lambda x: 0.6 if x else 0.4</div>
<div class="line">        )</div>
<div class="line">b = NumCatRVariable(</div>
<div class="line">    node_id=&quot;b&quot;, input_data=idata[&quot;b&quot;], distribution=lambda x: 0.5 if x else 0.5</div>
<div class="line">)</div>
<div class="line">c = NumCatRVariable(</div>
<div class="line">    node_id=&quot;c&quot;, input_data=idata[&quot;c&quot;], distribution=lambda x: 0.5 if x else 0.5</div>
<div class="line">)</div>
<div class="line">ab = Edge(</div>
<div class="line">    edge_id=&quot;ab&quot;,</div>
<div class="line">    edge_type=EdgeType.UNDIRECTED,</div>
<div class="line">    start_node=a,</div>
<div class="line">    end_node=b,</div>
<div class="line">)</div>
<div class="line">bc = Edge(</div>
<div class="line">    edge_id=&quot;bc&quot;,</div>
<div class="line">    edge_type=EdgeType.UNDIRECTED,</div>
<div class="line">    start_node=b,</div>
<div class="line">    end_node=c,</div>
<div class="line">)</div>
<div class="line">def phi_ba(scope_product):</div>
<div class="line">    &quot;&quot;</div>
<div class="line">    ss = set(scope_product)</div>
<div class="line">    if ss == set([(&quot;a&quot;, True), (&quot;b&quot;, True)]):</div>
<div class="line">        return 0.9</div>
<div class="line">    elif ss == set([(&quot;a&quot;, True), (&quot;b&quot;, False)]):</div>
<div class="line">        return 0.1</div>
<div class="line">    elif ss == set([(&quot;a&quot;, False), (&quot;b&quot;, True)]):</div>
<div class="line">        return 0.2</div>
<div class="line">    elif ss == set([(&quot;a&quot;, False), (&quot;b&quot;, False)]):</div>
<div class="line">        return 0.8</div>
<div class="line">    else:</div>
<div class="line">        raise ValueError(&quot;product error&quot;)</div>
<div class="line">def phi_cb(scope_product):</div>
<div class="line">    &quot;&quot;</div>
<div class="line">    ss = set(scope_product)</div>
<div class="line">    if ss == set([(&quot;c&quot;, True), (&quot;b&quot;, True)]):</div>
<div class="line">        return 0.3</div>
<div class="line">    elif ss == set([(&quot;c&quot;, True), (&quot;b&quot;, False)]):</div>
<div class="line">        return 0.5</div>
<div class="line">    elif ss == set([(&quot;c&quot;, False), (&quot;b&quot;, True)]):</div>
<div class="line">        return 0.7</div>
<div class="line">    elif ss == set([(&quot;c&quot;, False), (&quot;b&quot;, False)]):</div>
<div class="line">        return 0.5</div>
<div class="line">    else:</div>
<div class="line">        raise ValueError(&quot;product error&quot;)</div>
<div class="line">def phi_a(scope_product):</div>
<div class="line">    s = set(scope_product)</div>
<div class="line">    if s == set([(&quot;a&quot;, True)]):</div>
<div class="line">        return 0.6</div>
<div class="line">    elif s == set([(&quot;a&quot;, False)]):</div>
<div class="line">        return 0.4</div>
<div class="line">    else:</div>
<div class="line">        raise ValueError(&quot;product error&quot;)</div>
<div class="line">ba_f = Factor(gid=&quot;ba&quot;, scope_vars=set([b, a]), factor_fn=phi_ba)</div>
<div class="line">cb_f = Factor(gid=&quot;cb&quot;, scope_vars=set([c, b]), factor_fn=phi_cb)</div>
<div class="line">a_f = Factor(gid=&quot;a&quot;, scope_vars=set([a]), factor_fn=phi_a)</div>
<div class="line">pgm = PGModel(</div>
<div class="line">    gid=&quot;pgm&quot;,</div>
<div class="line">    nodes=set([a, b, c]),</div>
<div class="line">    edges=set([ab, bc]),</div>
<div class="line">    factors=set([ba_f, cb_f, a_f]),</div>
<div class="line">)</div>
<div class="line">evidences = set([(&quot;a&quot;, True)])</div>
<div class="line">queries = set([c])</div>
<div class="line">product_factor, a = pgm.cond_prod_by_variable_elimination(queries, evidences)</div>
<div class="line">print(round( product_factor.phi_normal(set([(&quot;c&quot;, True)])), 4))</div>
<div class="line"># should give you 0.32</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md22"></a>
Markov Network Usage</h1>
<p>Markov Network is defined by Koller, Friedman 2009, p. 103 is </p><blockquote class="doxtable">
<p>As in a Bayesian network, the nodes in the graph of a Markov network represent the variables, and the edges correspond to a notion of direct probabilistic interaction between the neighboring variables â€” an interaction that is not mediated by any other variable in the network. </p>
</blockquote>
<p>Usage:</p>
<div class="fragment"><div class="line">idata = {</div>
<div class="line">    &quot;A&quot;: {&quot;outcome-values&quot;: [True, False]},</div>
<div class="line">    &quot;B&quot;: {&quot;outcome-values&quot;: [True, False]},</div>
<div class="line">    &quot;C&quot;: {&quot;outcome-values&quot;: [True, False]},</div>
<div class="line">    &quot;D&quot;: {&quot;outcome-values&quot;: [True, False]},</div>
<div class="line">}</div>
<div class="line">                                                                   </div>
<div class="line"># misconception example</div>
<div class="line">A = NumCatRVariable(</div>
<div class="line">    node_id=&quot;A&quot;, input_data=idata[&quot;A&quot;], distribution=lambda x: 0.5</div>
<div class="line">)</div>
<div class="line">B = NumCatRVariable(</div>
<div class="line">    node_id=&quot;B&quot;, input_data=idata[&quot;B&quot;], distribution=lambda x: 0.5</div>
<div class="line">)</div>
<div class="line">C = NumCatRVariable(</div>
<div class="line">    node_id=&quot;C&quot;, input_data=idata[&quot;C&quot;], distribution=lambda x: 0.5</div>
<div class="line">)</div>
<div class="line">D = NumCatRVariable(</div>
<div class="line">    node_id=&quot;D&quot;, input_data=idata[&quot;D&quot;], distribution=lambda x: 0.5</div>
<div class="line">)</div>
<div class="line">AB = Edge(</div>
<div class="line">    edge_id=&quot;AB&quot;,</div>
<div class="line">    edge_type=EdgeType.UNDIRECTED,</div>
<div class="line">    start_node=A,</div>
<div class="line">    end_node=B,</div>
<div class="line">)</div>
<div class="line">AD = Edge(</div>
<div class="line">    edge_id=&quot;AD&quot;,</div>
<div class="line">    edge_type=EdgeType.UNDIRECTED,</div>
<div class="line">    start_node=A,</div>
<div class="line">    end_node=D,</div>
<div class="line">)</div>
<div class="line">DC = Edge(</div>
<div class="line">    edge_id=&quot;DC&quot;,</div>
<div class="line">    edge_type=EdgeType.UNDIRECTED,</div>
<div class="line">    start_node=D,</div>
<div class="line">    end_node=C,</div>
<div class="line">)</div>
<div class="line">BC = Edge(</div>
<div class="line">    edge_id=&quot;BC&quot;,</div>
<div class="line">    edge_type=EdgeType.UNDIRECTED,</div>
<div class="line">    start_node=B,</div>
<div class="line">    end_node=C,</div>
<div class="line">)</div>
<div class="line">                                                                   </div>
<div class="line">def phi_AB(scope_product):</div>
<div class="line">    &quot;&quot;</div>
<div class="line">    ss = frozenset(scope_product)</div>
<div class="line">    if ss == frozenset([(&quot;A&quot;, False), (&quot;B&quot;, False)]):</div>
<div class="line">        return 30.0</div>
<div class="line">    elif ss == frozenset([(&quot;A&quot;, False), (&quot;B&quot;, True)]):</div>
<div class="line">        return 5.0</div>
<div class="line">    elif ss == frozenset([(&quot;A&quot;, True), (&quot;B&quot;, False)]):</div>
<div class="line">        return 1.0</div>
<div class="line">    elif ss == frozenset([(&quot;A&quot;, True), (&quot;B&quot;, True)]):</div>
<div class="line">        return 10.0</div>
<div class="line">    else:</div>
<div class="line">        raise ValueError(&quot;product error&quot;)</div>
<div class="line">                                                                   </div>
<div class="line">def phi_BC(scope_product):</div>
<div class="line">    &quot;&quot;</div>
<div class="line">    ss = frozenset(scope_product)</div>
<div class="line">    if ss == frozenset([(&quot;B&quot;, False), (&quot;C&quot;, False)]):</div>
<div class="line">        return 100.0</div>
<div class="line">    elif ss == frozenset([(&quot;B&quot;, False), (&quot;C&quot;, True)]):</div>
<div class="line">        return 1.0</div>
<div class="line">    elif ss == frozenset([(&quot;B&quot;, True), (&quot;C&quot;, False)]):</div>
<div class="line">        return 1.0</div>
<div class="line">    elif ss == frozenset([(&quot;B&quot;, True), (&quot;C&quot;, True)]):</div>
<div class="line">        return 100.0</div>
<div class="line">    else:</div>
<div class="line">        raise ValueError(&quot;product error&quot;)</div>
<div class="line">                                                                   </div>
<div class="line">def phi_CD(scope_product):</div>
<div class="line">    &quot;&quot;</div>
<div class="line">    ss = frozenset(scope_product)</div>
<div class="line">    if ss == frozenset([(&quot;C&quot;, False), (&quot;D&quot;, False)]):</div>
<div class="line">        return 1.0</div>
<div class="line">    elif ss == frozenset([(&quot;C&quot;, False), (&quot;D&quot;, True)]):</div>
<div class="line">        return 100.0</div>
<div class="line">    elif ss == frozenset([(&quot;C&quot;, True), (&quot;D&quot;, False)]):</div>
<div class="line">        return 100.0</div>
<div class="line">    elif ss == frozenset([(&quot;C&quot;, True), (&quot;D&quot;, True)]):</div>
<div class="line">        return 1.0</div>
<div class="line">    else:</div>
<div class="line">        raise ValueError(&quot;product error&quot;)</div>
<div class="line">                                                                   </div>
<div class="line">def phi_DA(scope_product):</div>
<div class="line">    &quot;&quot;</div>
<div class="line">    ss = frozenset(scope_product)</div>
<div class="line">    if ss == frozenset([(&quot;D&quot;, False), (&quot;A&quot;, False)]):</div>
<div class="line">        return 100.0</div>
<div class="line">    elif ss == frozenset([(&quot;D&quot;, False), (&quot;A&quot;, True)]):</div>
<div class="line">        return 1.0</div>
<div class="line">    elif ss == frozenset([(&quot;D&quot;, True), (&quot;A&quot;, False)]):</div>
<div class="line">        return 1.0</div>
<div class="line">    elif ss == frozenset([(&quot;D&quot;, True), (&quot;A&quot;, True)]):</div>
<div class="line">        return 100.0</div>
<div class="line">    else:</div>
<div class="line">        raise ValueError(&quot;product error&quot;)</div>
<div class="line">                                                                   </div>
<div class="line">AB_f = Factor(</div>
<div class="line">    gid=&quot;ab_f&quot;, scope_vars=set([A, B]), factor_fn=phi_AB</div>
<div class="line">)</div>
<div class="line">BC_f = Factor(</div>
<div class="line">    gid=&quot;bc_f&quot;, scope_vars=set([B, C]), factor_fn=phi_BC</div>
<div class="line">)</div>
<div class="line">CD_f = Factor(</div>
<div class="line">    gid=&quot;cd_f&quot;, scope_vars=set([C, D]), factor_fn=phi_CD</div>
<div class="line">)</div>
<div class="line">DA_f = Factor(</div>
<div class="line">    gid=&quot;da_f&quot;, scope_vars=set([D, A]), factor_fn=phi_DA</div>
<div class="line">)</div>
<div class="line">                                                                   </div>
<div class="line">mnetwork = MarkovNetwork(</div>
<div class="line">    gid=&quot;mnet&quot;,</div>
<div class="line">    nodes=set([A, B, C, D]),</div>
<div class="line">    edges=set([AB, AD, BC, DC]),</div>
<div class="line">    factors=set([DA_f, CD_f, BC_f, AB_f]),</div>
<div class="line">)</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md23"></a>
LWF Chain Graph Usage</h1>
<p>LWF Chain Graph, also known as Partially Directed Model, is a probabilistic graphical model. It's distinctive nature is best explained by Koller, Friedman 2009, p. 148: </p><blockquote class="doxtable">
<p>An edge between two nodes in the same chain component must be undirected, while an edge between two nodes in different chain components must be directed. </p>
</blockquote>
<p>S. Lauritzen, one of the main contributors (the L in LWF) of the subject, had written extensively on the subject. However probably the most through treatment of the subject is Lauritzen 1996, p. 158 - 220. He had also provided the causal interpretation of LWF chain graphs in <a href="http://doi.wiley.com/10.1111/1467-9868.00340">Lauritzen 2002</a>. The standard inference strategies on chain graphs are best explained in Cowell 2005 and more recently in Dechter 2019.</p>
<p>Usage:</p>
<div class="fragment"><div class="line">idata = {&quot;outcome-values&quot;: [True, False]}</div>
<div class="line">A = NumCatRVariable(</div>
<div class="line">       node_id=&quot;A&quot;, input_data=idata, distribution=lambda x: 0.5</div>
<div class="line">)</div>
<div class="line">B = NumCatRVariable(</div>
<div class="line">       node_id=&quot;B&quot;, input_data=idata, distribution=lambda x: 0.5</div>
<div class="line">)</div>
<div class="line">C = NumCatRVariable(</div>
<div class="line">       node_id=&quot;C&quot;, input_data=idata, distribution=lambda x: 0.5</div>
<div class="line">)</div>
<div class="line">D = NumCatRVariable(</div>
<div class="line">       node_id=&quot;D&quot;, input_data=idata, distribution=lambda x: 0.5</div>
<div class="line">)</div>
<div class="line">E = NumCatRVariable(</div>
<div class="line">       node_id=&quot;E&quot;, input_data=idata, distribution=lambda x: 0.5</div>
<div class="line">)</div>
<div class="line">F = NumCatRVariable(</div>
<div class="line">       node_id=&quot;F&quot;, input_data=idata, distribution=lambda x: 0.5</div>
<div class="line">)</div>
<div class="line">G = NumCatRVariable(</div>
<div class="line">       node_id=&quot;G&quot;, input_data=idata, distribution=lambda x: 0.5</div>
<div class="line">)</div>
<div class="line">H = NumCatRVariable(</div>
<div class="line">       node_id=&quot;H&quot;, input_data=idata, distribution=lambda x: 0.5</div>
<div class="line">)</div>
<div class="line">I = NumCatRVariable(</div>
<div class="line">       node_id=&quot;I&quot;, input_data=idata, distribution=lambda x: 0.5</div>
<div class="line">)</div>
<div class="line">K = NumCatRVariable(</div>
<div class="line">       node_id=&quot;K&quot;, input_data=idata, distribution=lambda x: 0.5</div>
<div class="line">)</div>
<div class="line">L = NumCatRVariable(</div>
<div class="line">       node_id=&quot;L&quot;, input_data=idata, distribution=lambda x: 0.5</div>
<div class="line">)</div>
<div class="line">#</div>
<div class="line">#  Cowell 2005, p. 110</div>
<div class="line">#</div>
<div class="line">#   A                      E---+</div>
<div class="line">#   |                          |</div>
<div class="line">#   +----+                 F &lt;-+</div>
<div class="line">#        |                 |</div>
<div class="line">#   B &lt;--+---&gt; C --&gt; D &lt;---+</div>
<div class="line">#   |                |</div>
<div class="line">#   +---&gt; H &lt;--------+----&gt; G</div>
<div class="line">#   |     |</div>
<div class="line">#   +---&gt; I</div>
<div class="line">#</div>
<div class="line">AB_c = Edge(</div>
<div class="line">  edge_id=&quot;AB&quot;,</div>
<div class="line">  start_node=A,</div>
<div class="line">  end_node=B,</div>
<div class="line">  edge_type=EdgeType.DIRECTED,</div>
<div class="line">)</div>
<div class="line">AC_c = Edge(</div>
<div class="line">  edge_id=&quot;AC&quot;,</div>
<div class="line">  start_node=A,</div>
<div class="line">  end_node=C,</div>
<div class="line">  edge_type=EdgeType.DIRECTED,</div>
<div class="line">)</div>
<div class="line">CD_c = Edge(</div>
<div class="line">  edge_id=&quot;CD&quot;,</div>
<div class="line">  start_node=C,</div>
<div class="line">  end_node=D,</div>
<div class="line">  edge_type=EdgeType.DIRECTED,</div>
<div class="line">)</div>
<div class="line">EF_c = Edge(</div>
<div class="line">  edge_id=&quot;EF&quot;,</div>
<div class="line">  start_node=E,</div>
<div class="line">  end_node=F,</div>
<div class="line">  edge_type=EdgeType.DIRECTED,</div>
<div class="line">)</div>
<div class="line">FD_c = Edge(</div>
<div class="line">  edge_id=&quot;FD&quot;,</div>
<div class="line">  start_node=F,</div>
<div class="line">  end_node=D,</div>
<div class="line">  edge_type=EdgeType.DIRECTED,</div>
<div class="line">)</div>
<div class="line">DG_c = Edge(</div>
<div class="line">  edge_id=&quot;DG&quot;,</div>
<div class="line">  start_node=D,</div>
<div class="line">  end_node=G,</div>
<div class="line">  edge_type=EdgeType.DIRECTED,</div>
<div class="line">)</div>
<div class="line">DH_c = Edge(</div>
<div class="line">  edge_id=&quot;DH&quot;,</div>
<div class="line">  start_node=D,</div>
<div class="line">  end_node=H,</div>
<div class="line">  edge_type=EdgeType.DIRECTED,</div>
<div class="line">)</div>
<div class="line">BH_c = Edge(</div>
<div class="line">  edge_id=&quot;BH&quot;,</div>
<div class="line">  start_node=B,</div>
<div class="line">  end_node=H,</div>
<div class="line">  edge_type=EdgeType.DIRECTED,</div>
<div class="line">)</div>
<div class="line">BI_c = Edge(</div>
<div class="line">  edge_id=&quot;BI&quot;,</div>
<div class="line">  start_node=B,</div>
<div class="line">  end_node=I,</div>
<div class="line">  edge_type=EdgeType.DIRECTED,</div>
<div class="line">)</div>
<div class="line">HI_c = Edge(</div>
<div class="line">  edge_id=&quot;HI&quot;,</div>
<div class="line">  start_node=H,</div>
<div class="line">  end_node=I,</div>
<div class="line">  edge_type=EdgeType.UNDIRECTED,</div>
<div class="line">)</div>
<div class="line">#</div>
<div class="line"># Factors</div>
<div class="line">#</div>
<div class="line">def phi_e(scope_product):</div>
<div class="line">    &quot;Visit to Asia factor p(a)</div>
<div class="line">    &quot;</div>
<div class="line">    ss = set(scope_product)</div>
<div class="line">    if ss == set([(&quot;E&quot;, True)]):</div>
<div class="line">        return 0.01</div>
<div class="line">    elif ss == set([(&quot;E&quot;, False)]):</div>
<div class="line">        return 0.99</div>
<div class="line">    else:</div>
<div class="line">        raise ValueError(&quot;Unknown scope product&quot;)</div>
<div class="line"> </div>
<div class="line">E_cf = Factor(gid=&quot;E_cf&quot;, scope_vars=set([E]), factor_fn=phi_e)</div>
<div class="line"> </div>
<div class="line">def phi_fe(scope_product):</div>
<div class="line">    &quot;Tuberculosis | Visit to Asia factor p(t,a)&quot;</div>
<div class="line">    ss = set(scope_product)</div>
<div class="line">    if ss == set([(&quot;F&quot;, True), (&quot;E&quot;, True)]):</div>
<div class="line">        return 0.05</div>
<div class="line">    elif ss == set([(&quot;F&quot;, False), (&quot;E&quot;, True)]):</div>
<div class="line">        return 0.95</div>
<div class="line">    elif ss == set([(&quot;F&quot;, True), (&quot;E&quot;, False)]):</div>
<div class="line">        return 0.01</div>
<div class="line">    elif ss == set([(&quot;F&quot;, False), (&quot;E&quot;, False)]):</div>
<div class="line">        return 0.99</div>
<div class="line">    else:</div>
<div class="line">        raise ValueError(&quot;Unknown scope product&quot;)</div>
<div class="line"> </div>
<div class="line">EF_cf = Factor(</div>
<div class="line">    gid=&quot;EF_cf&quot;, scope_vars=set([E, F]), factor_fn=phi_fe</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">def phi_dg(scope_product):</div>
<div class="line">    &quot;either tuberculosis or lung cancer | x ray p(e,x)&quot;</div>
<div class="line">    ss = set(scope_product)</div>
<div class="line">    if ss == set([(&quot;D&quot;, True), (&quot;G&quot;, True)]):</div>
<div class="line">        return 0.98</div>
<div class="line">    elif ss == set([(&quot;D&quot;, False), (&quot;G&quot;, True)]):</div>
<div class="line">        return 0.05</div>
<div class="line">    elif ss == set([(&quot;D&quot;, True), (&quot;G&quot;, False)]):</div>
<div class="line">        return 0.02</div>
<div class="line">    elif ss == set([(&quot;D&quot;, False), (&quot;G&quot;, False)]):</div>
<div class="line">        return 0.95</div>
<div class="line">    else:</div>
<div class="line">        raise ValueError(&quot;Unknown scope product&quot;)</div>
<div class="line"> </div>
<div class="line">DG_cf = Factor(</div>
<div class="line">    gid=&quot;DG_cf&quot;, scope_vars=set([D, G]), factor_fn=phi_dg</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">def phi_a(scope_product):</div>
<div class="line">    &quot;smoke factor p(s)&quot;</div>
<div class="line">    ss = set(scope_product)</div>
<div class="line">    if ss == set([(&quot;A&quot;, True)]):</div>
<div class="line">        return 0.5</div>
<div class="line">    elif ss == set([(&quot;A&quot;, False)]):</div>
<div class="line">        return 0.5</div>
<div class="line">    else:</div>
<div class="line">        raise ValueError(&quot;Unknown scope product&quot;)</div>
<div class="line"> </div>
<div class="line">A_cf = Factor(gid=&quot;A_cf&quot;, scope_vars=set([A]), factor_fn=phi_a)</div>
<div class="line"> </div>
<div class="line">def phi_ab(scope_product):</div>
<div class="line">    &quot;smoke given bronchitis p(s,b)&quot;</div>
<div class="line">    ss = set(scope_product)</div>
<div class="line">    if ss == set([(&quot;A&quot;, True), (&quot;B&quot;, True)]):</div>
<div class="line">        return 0.6</div>
<div class="line">    elif ss == set([(&quot;A&quot;, False), (&quot;B&quot;, True)]):</div>
<div class="line">        return 0.3</div>
<div class="line">    elif ss == set([(&quot;A&quot;, True), (&quot;B&quot;, False)]):</div>
<div class="line">        return 0.4</div>
<div class="line">    elif ss == set([(&quot;A&quot;, False), (&quot;B&quot;, False)]):</div>
<div class="line">        return 0.7</div>
<div class="line">    else:</div>
<div class="line">        raise ValueError(&quot;Unknown scope product&quot;)</div>
<div class="line"> </div>
<div class="line">AB_cf = Factor(</div>
<div class="line">    gid=&quot;AB_cf&quot;, scope_vars=set([A, B]), factor_fn=phi_ab</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">def phi_ac(scope_product):</div>
<div class="line">    &quot;lung cancer given smoke p(s,l)&quot;</div>
<div class="line">    ss = set(scope_product)</div>
<div class="line">    if ss == set([(&quot;A&quot;, True), (&quot;C&quot;, True)]):</div>
<div class="line">        return 0.1</div>
<div class="line">    elif ss == set([(&quot;A&quot;, False), (&quot;C&quot;, True)]):</div>
<div class="line">        return 0.01</div>
<div class="line">    elif ss == set([(&quot;A&quot;, True), (&quot;C&quot;, False)]):</div>
<div class="line">        return 0.9</div>
<div class="line">    elif ss == set([(&quot;A&quot;, False), (&quot;C&quot;, False)]):</div>
<div class="line">        return 0.99</div>
<div class="line">    else:</div>
<div class="line">        raise ValueError(&quot;Unknown scope product&quot;)</div>
<div class="line"> </div>
<div class="line">AC_cf = Factor(</div>
<div class="line">    gid=&quot;AC_cf&quot;, scope_vars=set([A, C]), factor_fn=phi_ac</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">def phi_cdf(scope_product):</div>
<div class="line">    &quot;either tuberculosis or lung given lung cancer and tuberculosis p(e, l, t)&quot;</div>
<div class="line">    ss = set(scope_product)</div>
<div class="line">    if ss == set([(&quot;C&quot;, True), (&quot;D&quot;, True), (&quot;F&quot;, True)]):</div>
<div class="line">        return 1</div>
<div class="line">    elif ss == set([(&quot;C&quot;, True), (&quot;D&quot;, False), (&quot;F&quot;, True)]):</div>
<div class="line">        return 0</div>
<div class="line">    elif ss == set([(&quot;C&quot;, False), (&quot;D&quot;, True), (&quot;F&quot;, True)]):</div>
<div class="line">        return 1</div>
<div class="line">    elif ss == set([(&quot;C&quot;, False), (&quot;D&quot;, False), (&quot;F&quot;, True)]):</div>
<div class="line">        return 0</div>
<div class="line">    elif ss == set([(&quot;C&quot;, True), (&quot;D&quot;, True), (&quot;F&quot;, False)]):</div>
<div class="line">        return 1</div>
<div class="line">    elif ss == set([(&quot;C&quot;, True), (&quot;D&quot;, False), (&quot;F&quot;, False)]):</div>
<div class="line">        return 0</div>
<div class="line">    elif ss == set([(&quot;C&quot;, False), (&quot;D&quot;, True), (&quot;F&quot;, False)]):</div>
<div class="line">        return 0</div>
<div class="line">    elif ss == set([(&quot;C&quot;, False), (&quot;D&quot;, False), (&quot;F&quot;, False)]):</div>
<div class="line">        return 1</div>
<div class="line">    else:</div>
<div class="line">        raise ValueError(&quot;Unknown scope product&quot;)</div>
<div class="line"> </div>
<div class="line">CDF_cf = Factor(</div>
<div class="line">    gid=&quot;CDF_cf&quot;, scope_vars=set([D, C, F]), factor_fn=phi_cdf</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">def phi_ihb(scope_product):</div>
<div class="line">    &quot;cough, dyspnoea, bronchitis I, H, B p(c,d,b)&quot;</div>
<div class="line">    ss = set(scope_product)</div>
<div class="line">    if ss == set([(&quot;H&quot;, True), (&quot;I&quot;, True), (&quot;B&quot;, True)]):</div>
<div class="line">        return 16</div>
<div class="line">    elif ss == set([(&quot;H&quot;, True), (&quot;I&quot;, False), (&quot;B&quot;, True)]):</div>
<div class="line">        return 1</div>
<div class="line">    elif ss == set([(&quot;H&quot;, False), (&quot;I&quot;, True), (&quot;B&quot;, True)]):</div>
<div class="line">        return 4</div>
<div class="line">    elif ss == set([(&quot;H&quot;, False), (&quot;I&quot;, False), (&quot;B&quot;, True)]):</div>
<div class="line">        return 1</div>
<div class="line">    elif ss == set([(&quot;H&quot;, True), (&quot;I&quot;, True), (&quot;B&quot;, False)]):</div>
<div class="line">        return 2</div>
<div class="line">    elif ss == set([(&quot;H&quot;, True), (&quot;I&quot;, False), (&quot;B&quot;, False)]):</div>
<div class="line">        return 1</div>
<div class="line">    elif ss == set([(&quot;H&quot;, False), (&quot;I&quot;, True), (&quot;B&quot;, False)]):</div>
<div class="line">        return 1</div>
<div class="line">    elif ss == set([(&quot;H&quot;, False), (&quot;I&quot;, False), (&quot;B&quot;, False)]):</div>
<div class="line">        return 1</div>
<div class="line">    else:</div>
<div class="line">        raise ValueError(&quot;Unknown scope product&quot;)</div>
<div class="line"> </div>
<div class="line">IHB_cf = Factor(</div>
<div class="line">    gid=&quot;IHB_cf&quot;, scope_vars=set([H, I, B]), factor_fn=phi_ihb</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">def phi_hbd(scope_product):</div>
<div class="line">    &quot;cough, either tuberculosis or lung cancer, bronchitis D, H, B p(c,b,e)&quot;</div>
<div class="line">    ss = set(scope_product)</div>
<div class="line">    if ss == set([(&quot;H&quot;, True), (&quot;D&quot;, True), (&quot;B&quot;, True)]):</div>
<div class="line">        return 5</div>
<div class="line">    elif ss == set([(&quot;H&quot;, True), (&quot;D&quot;, False), (&quot;B&quot;, True)]):</div>
<div class="line">        return 2</div>
<div class="line">    elif ss == set([(&quot;H&quot;, False), (&quot;D&quot;, True), (&quot;B&quot;, True)]):</div>
<div class="line">        return 1</div>
<div class="line">    elif ss == set([(&quot;H&quot;, False), (&quot;D&quot;, False), (&quot;B&quot;, True)]):</div>
<div class="line">        return 1</div>
<div class="line">    elif ss == set([(&quot;H&quot;, True), (&quot;D&quot;, True), (&quot;B&quot;, False)]):</div>
<div class="line">        return 3</div>
<div class="line">    elif ss == set([(&quot;H&quot;, True), (&quot;D&quot;, False), (&quot;B&quot;, False)]):</div>
<div class="line">        return 1</div>
<div class="line">    elif ss == set([(&quot;H&quot;, False), (&quot;D&quot;, True), (&quot;B&quot;, False)]):</div>
<div class="line">        return 1</div>
<div class="line">    elif ss == set([(&quot;H&quot;, False), (&quot;D&quot;, False), (&quot;B&quot;, False)]):</div>
<div class="line">        return 1</div>
<div class="line">    else:</div>
<div class="line">        raise ValueError(&quot;Unknown scope product&quot;)</div>
<div class="line"> </div>
<div class="line">HBD_cf = Factor(</div>
<div class="line">    gid=&quot;HBD_cf&quot;, scope_vars=set([H, D, B]), factor_fn=phi_hbd</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">def phi_bd(scope_product):</div>
<div class="line">    &quot;bronchitis, either tuberculosis or lung cancer B, D p(b,e)&quot;</div>
<div class="line">    ss = set(scope_product)</div>
<div class="line">    if ss == set([(&quot;B&quot;, True), (&quot;D&quot;, True)]):</div>
<div class="line">        return 1 / 90</div>
<div class="line">    elif ss == set([(&quot;B&quot;, False), (&quot;D&quot;, True)]):</div>
<div class="line">        return 1 / 11</div>
<div class="line">    elif ss == set([(&quot;B&quot;, True), (&quot;D&quot;, False)]):</div>
<div class="line">        return 1 / 39</div>
<div class="line">    elif ss == set([(&quot;B&quot;, False), (&quot;D&quot;, False)]):</div>
<div class="line">        return 1 / 5</div>
<div class="line">    else:</div>
<div class="line">        raise ValueError(&quot;Unknown scope product&quot;)</div>
<div class="line"> </div>
<div class="line">BD_cf = Factor(</div>
<div class="line">    gid=&quot;BD_cf&quot;, scope_vars=set([D, B]), factor_fn=phi_bd</div>
<div class="line">)</div>
<div class="line"> </div>
<div class="line">cowell = LWFChainGraph(</div>
<div class="line">    gid=&quot;cowell&quot;,</div>
<div class="line">    nodes=set([A, B, C, D, E, F, G, H, I]),</div>
<div class="line">    edges=set([AB_c, AC_c, CD_c, EF_c, FD_c, DG_c, DH_c, BH_c, BI_c, HI_c]),</div>
<div class="line">    factors=set([E_cf, EF_cf, DG_cf, A_cf, AB_cf, AC_cf, CDF_cf, IHB_cf, HBD_cf, </div>
<div class="line">        BD_cf])</div>
<div class="line">)</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="../../doxygen.png" alt="doxygen"/>
</a> 1.8.19
</small></address>
</body>
</html>
